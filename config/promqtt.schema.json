{"title": "PromqttConfig", "description": "Configuration file data model for promqtt", "type": "object", "properties": {"mqtt": {"$ref": "#/definitions/MqttModel"}, "http": {"$ref": "#/definitions/HttpServerConfig"}, "metrics": {"title": "Metrics", "type": "object", "additionalProperties": {"$ref": "#/definitions/MetricModel"}}, "types": {"title": "Types", "type": "object", "additionalProperties": {"type": "object", "additionalProperties": {"$ref": "#/definitions/TypeConfig"}}}, "messages": {"title": "Messages", "type": "array", "items": {"$ref": "#/definitions/MessageConfig"}}}, "required": ["mqtt", "http", "metrics", "types", "messages"], "additionalProperties": false, "definitions": {"MqttModel": {"title": "MqttModel", "description": "MQTT broker settings", "type": "object", "properties": {"broker": {"title": "Broker", "description": "The hostname of the MQTT broker", "type": "string"}, "port": {"title": "Port", "description": "The MQTT port to connect to.", "default": 1883, "type": "integer"}, "topic": {"title": "Topic", "description": "The topic to subscribe", "default": "#", "type": "string"}}, "required": ["broker"], "additionalProperties": false}, "HttpServerConfig": {"title": "HttpServerConfig", "description": "HTTP server related settings", "type": "object", "properties": {"interface": {"title": "Interface", "description": "Interface address to listen on", "default": "0.0.0.0", "type": "string"}, "port": {"title": "Port", "description": "Port number", "default": 8086, "type": "integer"}}, "additionalProperties": false}, "MetricTypeEnum": {"title": "MetricTypeEnum", "description": "Enumeration of metric types", "enum": ["gauge", "counter"]}, "MetricModel": {"title": "MetricModel", "description": "Configuration of a metric", "type": "object", "properties": {"type": {"description": "Metric type", "allOf": [{"$ref": "#/definitions/MetricTypeEnum"}]}, "help": {"title": "Help", "description": "Metric help text", "default": "", "type": "string"}, "timeout": {"title": "Timeout", "description": "Timeout time in seconds of this metric. When the metric has not been updated for this time, it is removed from Prometheus output.", "default": 0, "type": "integer"}, "with_update_counter": {"title": "With Update Counter", "description": "Enable update counter metric", "default": false, "type": "boolean"}}, "required": ["type"], "additionalProperties": false}, "TypeConfig": {"title": "TypeConfig", "description": "Configuration of a type / device", "type": "object", "properties": {"value": {"title": "Value", "description": "The python expression to extract a value from the messsage", "type": "string"}, "labels": {"title": "Labels", "description": "The labels attached to a metric", "type": "object", "additionalProperties": {"type": "string"}}}, "required": ["value", "labels"], "additionalProperties": false}, "ParserTypeEnum": {"title": "ParserTypeEnum", "description": "Types of MQTT message parsers", "enum": ["json"]}, "MessageConfig": {"title": "MessageConfig", "description": "Message configuration. This configures which types process which MQTT messages.", "type": "object", "properties": {"topics": {"title": "Topics", "description": "The topics which receive relevant messages", "type": "array", "items": {"type": "string"}}, "types": {"title": "Types", "description": "The types that process the messages", "type": "array", "items": {"type": "string"}}, "parser": {"description": "The parser that converts the incoming message to a data structure.", "default": "json", "allOf": [{"$ref": "#/definitions/ParserTypeEnum"}]}}, "required": ["topics", "types"], "additionalProperties": false}}}